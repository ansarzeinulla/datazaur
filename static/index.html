<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI –î–∏–∞–≥–Ω–æ—Å—Ç –†–ö</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100 min-h-screen p-8">
    <div class="max-w-3xl mx-auto bg-white rounded-xl shadow-md p-6">
        <h1 class="text-2xl font-bold text-blue-600 mb-4">ü©∫ AI-–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç –î–∏–∞–≥–Ω–æ—Å—Ç–∞</h1>
        <p class="text-gray-600 mb-4">–í–≤–µ–¥–∏—Ç–µ —Å–∏–º–ø—Ç–æ–º—ã –∏ –∞–Ω–∞–º–Ω–µ–∑ –ø–∞—Ü–∏–µ–Ω—Ç–∞ –≤ —Å–≤–æ–±–æ–¥–Ω–æ–π —Ñ–æ—Ä–º–µ:</p>

        <textarea id="symptoms" rows="5"
            class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"
            placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ 39, —Å—É—Ö–æ–π –∫–∞—à–µ–ª—å, —Å–ª–∞–±–æ—Å—Ç—å, –ø–æ—Ç–µ—Ä—è –æ–±–æ–Ω—è–Ω–∏—è..."></textarea>

        <button id="btn" onclick="analyze()"
            class="mt-4 bg-blue-600 text-white px-6 py-2 rounded-lg font-medium hover:bg-blue-700 transition w-full">
            –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–∏–º–ø—Ç–æ–º—ã
        </button>

        <div id="loading" class="hidden mt-6 text-center text-gray-500 animate-pulse">
            ü§ñ AI –∏—â–µ—Ç –ø–æ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞–º –†–ö, –ø–æ–¥–æ–∂–¥–∏—Ç–µ (–æ–∫–æ–ª–æ 10 —Å–µ–∫—É–Ω–¥)...
        </div>

        <div id="results" class="mt-6 space-y-4"></div>
    </div>

    <script>
        async function analyze() {
            const text = document.getElementById('symptoms').value;
            if (!text) return alert("–í–≤–µ–¥–∏—Ç–µ —Å–∏–º–ø—Ç–æ–º—ã!");

            document.getElementById('loading').classList.remove('hidden');
            document.getElementById('results').innerHTML = '';
            document.getElementById('btn').disabled = true;

            try {
                const response = await fetch('/diagnose', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ symptoms: text })
                });

                const data = await response.json();

                let html = '<h2 class="text-xl font-bold text-gray-800 mb-3">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞:</h2>';
                data.diagnoses.forEach(d => {
                    html += `
                    <div class="p-4 border-l-4 border-blue-500 bg-blue-50 rounded-r-lg">
                        <div class="flex justify-between items-start">
                            <h3 class="font-bold text-lg">${d.name}</h3>
                            <span class="bg-blue-200 text-blue-800 text-xs font-bold px-2 py-1 rounded">–ú–ö–ë-10: ${d.icd10_code}</span>
                        </div>
                        <p class="text-sm text-gray-700 mt-2"><strong>–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:</strong> ${d.explanation}</p>
                    </div>`;
                });
                document.getElementById('results').innerHTML = html;
            } catch (e) {
                document.getElementById('results').innerHTML = '<p class="text-red-500">–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –∫ —Å–µ—Ä–≤–µ—Ä—É.</p>';
            } finally {
                document.getElementById('loading').classList.add('hidden');
                document.getElementById('btn').disabled = false;
            }
        }
    </script>
</body>

</html>